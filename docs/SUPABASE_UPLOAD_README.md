# Uploading SIC Codes to Supabase

This document provides instructions for uploading the scraped SIC codes to a Supabase database.

## Prerequisites

- A Supabase account and project
- The `sic_codes.csv` file generated by the scraper
- Python 3.6+

## Steps to Upload

### 1. Create the table in Supabase

There are two ways to create the required table in Supabase:

**Option 1: Using the SQL Editor in Supabase Dashboard**

1. Log in to your Supabase dashboard
2. Navigate to the SQL Editor
3. Copy and paste the contents of `create_sic_table.sql` in this repository
4. Run the SQL query to create the table

**Option 2: Using the Supabase Dashboard UI**

1. Log in to your Supabase dashboard
2. Navigate to Database â†’ Tables
3. Click "Create a new table"
4. Name the table `sic_codes`
5. Add the following columns:
   - `sic_code` (type: text, Primary key: yes)
   - `description` (type: text)
   - `section` (type: text)
   - `section_title` (type: text)

### 2. Set up environment variables

1. Copy the `.env.example` file to a new file named `.env`:
   ```
   cp .env.example .env
   ```

2. Edit the `.env` file and add your Supabase URL and anon key:
   ```
   SUPABASE_URL=https://your-project-id.supabase.co
   SUPABASE_KEY=your-supabase-anon-key
   ```

   You can find these values in your Supabase project settings under "API".

### 3. Install required packages

Make sure the required packages are installed:

```bash
pip install supabase python-dotenv
```

### 4. Run the upload script

Run the script to upload the SIC codes to Supabase:

```bash
python upload_sic_to_supabase.py
```

The script will:
- Read the SIC codes from the CSV file
- Connect to your Supabase project
- Upload the data in batches to the `sic_codes` table
- Display progress information

## Troubleshooting

### Connection Issues

If you encounter connection issues:
- Verify your Supabase URL and key in the `.env` file
- Check your internet connection
- Ensure your IP is not blocked by Supabase

### Permission Errors

If you encounter permission errors:
- Make sure you're using the correct key (anon key or service role key)
- Check that your Supabase account has permissions to write to tables

### Rate Limiting

If you encounter rate limiting errors:
- Adjust the sleep time in the script (currently set to 1 second)
- Try reducing the batch size

## Using SIC Codes in Your Application

Once uploaded, you can query the SIC codes in your application using:

```sql
-- Get all SIC codes
SELECT * FROM sic_codes;

-- Search for SIC codes by description
SELECT * FROM sic_codes 
WHERE description ILIKE '%agriculture%';

-- Get all SIC codes for a specific section
SELECT * FROM sic_codes 
WHERE section = 'Section A';
``` 